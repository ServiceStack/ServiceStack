var __awaiter=this&&this.__awaiter||function(e,a,s,u){return new(s||(s=Promise))(function(t,n){function r(e){try{o(u.next(e))}catch(e){n(e)}}function i(e){try{o(u.throw(e))}catch(e){n(e)}}function o(e){e.done?t(e.value):function(t){return t instanceof s?t:new s(function(e){e(t)})}(e.value).then(r,i)}o((u=u.apply(e,a||[])).next())})},__generator=this&&this.__generator||function(n,r){var i,o,a,e,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,o&&(a=2&t[0]?o.return:t[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,t[1])).done)return a;switch(o=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,o=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=r.call(n,s)}catch(e){t=[6,e],o=0}finally{i=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};!function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports);void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd?define(["require","exports"],e):"undefined"!=typeof window&&e(window.require||function(){},window["@servicestack/desktop"]={})}(function(e,t){"use strict";function n(e,o){return __awaiter(this,void 0,void 0,function(){var t,n,r,i;return __generator(this,function(e){switch(e.label){case 0:for(n in t=new FormData,o)o.hasOwnProperty(n)&&t.append(n,o[n]);e.label=1;case 1:return e.trys.push([1,4,,5]),[4,fetch("https://host/script",{method:"POST",body:t})];case 2:return[4,(r=e.sent()).text()];case 3:if(i=e.sent(),r.ok)return[2,0<i.length?JSON.parse(i):null];throw i;case 4:throw e.sent();case 5:return[2]}})})}function r(e,r){return __awaiter(this,void 0,void 0,function(){var t,n;return __generator(this,function(e){switch(e.label){case 0:for(n in t=new FormData,r)r.hasOwnProperty(n)&&t.append(n,r[n]);e.label=1;case 1:return e.trys.push([1,4,,5]),[4,fetch("https://host/script",{method:"POST",body:t})];case 2:return[4,e.sent().text()];case 3:return[2,e.sent()];case 4:throw e.sent();case 5:return[2]}})})}function i(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n,r,i=[];for(n=0,r=e.length;n<r;n++){var o=e[n];i=-1===o.indexOf("://")?i.concat(o.split("/")):i.concat(o.lastIndexOf("/")===o.length-1?o.substring(0,o.length-1):o)}var a=[];for(n=0,r=i.length;n<r;n++){var s=i[n];s&&"."!==s&&(".."===s?a.pop():a.push(s))}return""===i[0]&&a.unshift(""),a.join("/")||(a.length?"/":".")}function o(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,n(0,{EvaluateCode:t})];case 1:return[2,e.sent()]}})})}function a(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,n(0,{EvaluateCodeAsync:t})];case 1:return[2,e.sent()]}})})}function s(e){return'"'+e.replace('"','\\"')+'"'}function u(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,o(t)];case 1:return[2,e.sent()]}})})}function c(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,a(t)];case 1:return[2,e.sent()]}})})}function d(n,r){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return[4,fetch("/desktop/"+n+"/"+r)];case 1:if(!(t=e.sent()).ok)throw t.status+" "+t.statusText;return[4,t.text()];case 2:return[2,e.sent()]}})})}function l(n,r,i){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,3,,4]),[4,fetch("/desktop/"+n+"/"+r,{method:"POST",body:i})];case 1:if(!(t=e.sent()).ok)throw t.status+" "+t.statusText;return[4,t.text()];case 2:return[2,e.sent()];case 3:throw e.sent();case 4:return[2]}})})}var w,f,h,_,v,p;Object.defineProperty(t,"__esModule",{value:!0}),t.messageBox=t.KnownFolders=t.MessageBoxReturn=t.MessageBoxType=t.openFolder=t.openFile=t.OpenFolderFlags=t.ShowWindowCommands=t.desktopSaveDownloadUrl=t.desktopSaveDownloadsTextFile=t.desktopDownloadsTextFile=t.desktopSaveTextFile=t.desktopTextFile=t.knownFolder=t.windowSetState=t.windowClientRect=t.windowClientSize=t.windowSize=t.windowSetText=t.windowText=t.windowHide=t.windowShow=t.windowIsEnabled=t.windowIsVisible=t.windowRedrawFrame=t.windowSetSize=t.windowSetPosition=t.windowShowScrollBar=t.windowSetFocus=t.windowSetFullScreen=t.windowCenterToScreen=t.windowSendToForeground=t.primaryMonitorInfo=t.deviceScreenResolution=t.setClipboard=t.clipboard=t.findWindowByName=t.expandEnvVars=t.start=t.openUrl=t.desktopInfo=t.evalToBoolAsync=t.evalToBool=t.quote=t.renderLispAsync=t.renderCodeAsync=t.renderScriptAsync=t.evaluateLispAsync=t.evaluateCodeAsync=t.evaluateScriptAsync=t.renderLisp=t.renderCode=t.renderScript=t.evaluateLisp=t.evaluateCode=t.evaluateScript=t.combinePaths=t.invokeHostTextMethod=t.invokeHostJsonMethod=void 0,t.invokeHostJsonMethod=n,t.invokeHostTextMethod=r,t.combinePaths=i,t.evaluateScript=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,n(0,{EvaluateScript:t})];case 1:return[2,e.sent()]}})})},t.evaluateCode=o,t.evaluateLisp=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,n(0,{EvaluateLisp:t})];case 1:return[2,e.sent()]}})})},t.renderScript=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,r(0,{RenderScript:t})];case 1:return[2,e.sent()]}})})},t.renderCode=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,r(0,{RenderCode:t})];case 1:return[2,e.sent()]}})})},t.renderLisp=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,r(0,{RenderLisp:t})];case 1:return[2,e.sent()]}})})},t.evaluateScriptAsync=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,n(0,{EvaluateScriptAsync:t})];case 1:return[2,e.sent()]}})})},t.evaluateCodeAsync=a,t.evaluateLispAsync=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,n(0,{EvaluateLispAsync:t})];case 1:return[2,e.sent()]}})})},t.renderScriptAsync=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,r(0,{RenderScriptAsync:t})];case 1:return[2,e.sent()]}})})},t.renderCodeAsync=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,r(0,{RenderCodeAsync:t})];case 1:return[2,e.sent()]}})})},t.renderLispAsync=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,r(0,{RenderLispAsync:t})];case 1:return[2,e.sent()]}})})},t.quote=s,t.evalToBool=u,t.evalToBoolAsync=c,t.desktopInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,o("desktopInfo")];case 1:return[2,e.sent()]}})})},t.openUrl=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,u("openUrl("+s(t)+")")];case 1:return[2,e.sent()]}})})},t.start=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,u("start("+s(t)+")")];case 1:return[2,e.sent()]}})})},t.expandEnvVars=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,o("expandEnvVars("+s(t)+")")];case 1:return[2,e.sent()]}})})},t.findWindowByName=function(n){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return t=parseInt,[4,o("findWindowByName("+s(n)+")")];case 1:return[2,t.apply(void 0,[e.sent()])]}})})},t.clipboard=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,o("clipboard")];case 1:return[2,e.sent()]}})})},t.setClipboard=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,u("setClipboard("+s(t)+")")];case 1:return[2,e.sent()]}})})},t.deviceScreenResolution=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,o("deviceScreenResolution")];case 1:return[2,e.sent()]}})})},t.primaryMonitorInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,o("primaryMonitorInfo")];case 1:return[2,e.sent()]}})})},t.windowSendToForeground=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,u("windowSendToForeground")];case 1:return[2,e.sent()]}})})},t.windowCenterToScreen=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,u(t?"windowCenterToScreen("+t+")":"windowCenterToScreen")];case 1:return[2,e.sent()]}})})},t.windowSetFullScreen=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,c("windowSetFullScreen")];case 1:return[2,e.sent()]}})})},t.windowSetFocus=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,u("windowSetFocus")];case 1:return[2,e.sent()]}})})},t.windowShowScrollBar=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,c("windowShowScrollBar("+t+")")];case 1:return[2,e.sent()]}})})},t.windowSetPosition=function(t,n,r,i){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,c(r?"windowSetPosition("+t+","+n+","+r+","+i+")":"windowSetPosition("+t+","+n+")")];case 1:return[2,e.sent()]}})})},t.windowSetSize=function(t,n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,c("windowSetSize("+t+","+n+")")];case 1:return[2,e.sent()]}})})},t.windowRedrawFrame=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,u("windowRedrawFrame")];case 1:return[2,e.sent()]}})})},t.windowIsVisible=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,u("windowIsVisible")];case 1:return[2,e.sent()]}})})},t.windowIsEnabled=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,u("windowIsEnabled")];case 1:return[2,e.sent()]}})})},t.windowShow=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,u("windowShow")];case 1:return[2,e.sent()]}})})},t.windowHide=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,u("windowHide")];case 1:return[2,e.sent()]}})})},t.windowText=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,o("windowText")];case 1:return[2,e.sent()]}})})},t.windowSetText=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,u("windowSetText("+s(t)+")")];case 1:return[2,e.sent()]}})})},t.windowSize=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,o("windowSize")];case 1:return[2,e.sent()]}})})},t.windowClientSize=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,o("windowClientSize")];case 1:return[2,e.sent()]}})})},t.windowClientRect=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,o("windowClientRect")];case 1:return[2,e.sent()]}})})},t.windowSetState=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,u("windowSetState("+t+")")];case 1:return[2,e.sent()]}})})},t.knownFolder=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,o("knownFolder("+s(t)+")")];case 1:return[2,e.sent()]}})})},t.desktopTextFile=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,d("files",t)];case 1:return[2,e.sent()]}})})},t.desktopSaveTextFile=function(t,n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,l("files",t,n)];case 1:return[2,e.sent()]}})})},t.desktopDownloadsTextFile=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,d("downloads",t)];case 1:return[2,e.sent()]}})})},t.desktopSaveDownloadsTextFile=function(t,n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,l("downloads",t,n)];case 1:return[2,e.sent()]}})})},t.desktopSaveDownloadUrl=function(e,t){return i("/desktop/downloads",encodeURIComponent(e),"url",encodeURIComponent(t))},(w=t.ShowWindowCommands||(t.ShowWindowCommands={}))[w.Hide=0]="Hide",w[w.Normal=1]="Normal",w[w.ShowMinimized=2]="ShowMinimized",w[w.Maximize=3]="Maximize",w[w.ShowMaximized=3]="ShowMaximized",w[w.ShowNoActivate=4]="ShowNoActivate",w[w.Show=5]="Show",w[w.Minimize=6]="Minimize",w[w.ShowMinNoActive=7]="ShowMinNoActive",w[w.ShowNA=8]="ShowNA",w[w.Restore=9]="Restore",w[w.ShowDefault=10]="ShowDefault",w[w.ForceMinimize=11]="ForceMinimize",(f=t.OpenFolderFlags||(t.OpenFolderFlags={}))[f.AllowMultiSelect=512]="AllowMultiSelect",f[f.CreatePrompt=8192]="CreatePrompt",f[f.DontAddToRecent=33554432]="DontAddToRecent",f[f.EnableHook=32]="EnableHook",f[f.EnableIncludeNotify=4194304]="EnableIncludeNotify",f[f.EnableSizing=8388608]="EnableSizing",f[f.EnableTemplate=64]="EnableTemplate",f[f.EnableTemplateHandle=128]="EnableTemplateHandle",f[f.Explorer=524288]="Explorer",f[f.ExtensionIsDifferent=1024]="ExtensionIsDifferent",f[f.FileMustExist=4096]="FileMustExist",f[f.ForceShowHidden=268435456]="ForceShowHidden",f[f.HideReadOnly=4]="HideReadOnly",f[f.LongNames=2097152]="LongNames",f[f.NoChangeDir=8]="NoChangeDir",f[f.NoDereferenceLinks=1048576]="NoDereferenceLinks",f[f.NoLongNames=262144]="NoLongNames",f[f.NoNetworkButton=131072]="NoNetworkButton",f[f.NoReadOnlyReturn=32768]="NoReadOnlyReturn",f[f.NoTestFileCreate=65536]="NoTestFileCreate",f[f.NoValidate=256]="NoValidate",f[f.OverwritePrompt=2]="OverwritePrompt",f[f.PathMustExist=2048]="PathMustExist",f[f.ReadOnly=1]="ReadOnly",f[f.ShareAware=16384]="ShareAware",f[f.ShowHelp=16]="ShowHelp",t.openFile=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,o("openFile("+JSON.stringify(t)+")")];case 1:return[2,e.sent()]}})})},t.openFolder=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,o("openFolder("+JSON.stringify(t)+")")];case 1:return[2,e.sent()]}})})},(_=h=t.MessageBoxType||(t.MessageBoxType={}))[_.AbortRetryIgnore=2]="AbortRetryIgnore",_[_.CancelTryContinue=6]="CancelTryContinue",_[_.Help=16384]="Help",_[_.Ok=0]="Ok",_[_.OkCancel=1]="OkCancel",_[_.RetryCancel=5]="RetryCancel",_[_.YesNo=4]="YesNo",_[_.YesNoCancel=3]="YesNoCancel",_[_.IconExclamation=48]="IconExclamation",_[_.IconWarning=48]="IconWarning",_[_.IconInformation=64]="IconInformation",_[_.IconQuestion=32]="IconQuestion",_[_.IconStop=16]="IconStop",_[_.DefaultButton1=0]="DefaultButton1",_[_.DefaultButton2=256]="DefaultButton2",_[_.DefaultButton3=512]="DefaultButton3",_[_.DefaultButton4=768]="DefaultButton4",_[_.AppModal=0]="AppModal",_[_.SystemModal=4096]="SystemModal",_[_.TaskModal=8192]="TaskModal",_[_.DefaultDesktopOnly=131072]="DefaultDesktopOnly",_[_.RightJustified=524288]="RightJustified",_[_.RightToLeftReading=1048576]="RightToLeftReading",_[_.SetForeground=65536]="SetForeground",_[_.TopMost=262144]="TopMost",_[_.ServiceNotification=2097152]="ServiceNotification",(v=t.MessageBoxReturn||(t.MessageBoxReturn={}))[v.Abort=3]="Abort",v[v.Cancel=2]="Cancel",v[v.Continue=11]="Continue",v[v.Ignore=5]="Ignore",v[v.No=7]="No",v[v.Ok=1]="Ok",v[v.Retry=4]="Retry",v[v.TryAgain=10]="TryAgain",v[v.Yes=6]="Yes",(p=t.KnownFolders||(t.KnownFolders={})).Contacts="Contacts",p.Desktop="Desktop",p.Documents="Documents",p.Downloads="Downloads",p.Favorites="Favorites",p.Links="Links",p.Music="Music",p.Pictures="Pictures",p.SavedGames="SavedGames",p.SavedSearches="SavedSearches",p.Videos="Videos",t.messageBox=function(t,n,r){return void 0===n&&(n=""),void 0===r&&(r=h.Ok|h.TopMost),__awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,o("messageBox("+s(t)+","+s(n)+","+r+")")];case 1:return[2,e.sent()]}})})}});